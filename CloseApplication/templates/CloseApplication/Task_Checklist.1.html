{% extends "CloseApplication/base.html" %}

{% block title %}Task Checklist{% endblock %}
{% block content %}
    <table class ="table table-bordered table-hover" id="Task_ChecklistTable">
        <thead>
            <tr>
                <th></th>
                <th>Task ID</th>
                <th>Description</th>
                <th>Period</th>
                <th>Year</th>
                <th>Occurence</th>
                <th>Owner ID</th>
                <th>Status</th>
                <th>Journal Entry?</th>
                <th>Date Created</th>
            </tr>
        </thead>
        <tbody>
        {% for tableValue in TaskChecklist_Values %}
        {% with forloopCounter=forloop.counter|stringformat:"s" %}
        {% with idTemplate_Hash="#group-of-rows"|add:forloopCounter %}
        {% with idTemplate="group-of-rows"|add:forloopCounter %}
        <tr data-toggle="collapse" data-target="{{ idTemplate_Hash }}">
            <td><button class="open-button" onclick="openForm()">+</button></td>
            <td>{{ tableValue.taskId }}</td>
            <td>{{ tableValue.taskDescription }}</td>
            <td>{{ tableValue.taskPeriod }}</td>
            <td>{{ tableValue.taskYear }}</td>
            <td>{{ tableValue.get_taskOccurence_display }}</td>
            <td>{{ tableValue.taskOwnerId }}</td>
            <td>{{ tableValue.get_taskStatus_display }}</td>
            <td>{{ tableValue.isJE }}</td>
            <td>{{ tableValue.pub_date }}</td>
        </tr>
            {% for subTableValue in subTasklist_Values %}
                {% if tableValue.taskId == subTableValue.taskId|stringformat:"s" %} {# "stringformat" filter property required as subTableValue.taskId type is foreign key vs. charfield on other table #}
                    <tr id="{{ idTemplate }}">
                        <td></td>
                        <td colspan="9">{{ subTableValue.subTaskDescription }}</td>
                    </tr>
                {% endif %}
            {% endfor %}
            {% endwith %}
            {% endwith %}
            {% endwith %}
            {% endfor %}
        </tbody>
    </table>
{% endblock %}